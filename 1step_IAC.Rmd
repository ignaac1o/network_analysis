---
title: "1st_Step_IAC"
output: html_document
date: '2022-04-25'
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(igraph)
library(igraphdata)
load("bicimad-data.RData")
plot.igraph(bicimad)
```

## Identify relevant nodes and explain what information seems to be useful for understanding the network


In previous section we have already calculated the degree of each node. However, for this analysis it might be more useful to know which node is the one with highest degree, i.e that place were more bikes are taken and left. This node will mean one of the most concurred places for taking bicycles. 

This could represent that either other public transport methods are not accessible enough to get to that place of the city or that it is a place were most people visiting it are young and are willing to take a bike as a method to get there. We can easily obtain the index for the node with highest degree and its value, as well as the correspondent address:

```{r}
deg=degree(bicimad) %>% which.max()
degree(bicimad,deg)
vertex_attr(bicimad)$address[deg]
```

We can see that the node 57 is the one with highest degree (233). This corresponds to the station located in "Calle Valencia 1". Indeed, this street belongs to the neighborhood of "lavapies", which is one place that has been growing up a lot in Madrid in the past years. Always visited by young people as it is more affordable and more "cool" these days. Therefore, we could say that the results obtained makes total sense.

We could also consider calculating the degree using the weights. However, our network does not include weights. Therefore the results obtained will be the same.

```{r}
table(strength(bicimad))
graph_strength_distribution <- function (graph,cumulative=FALSE,...)
{
  if (!is.igraph(graph)) {
    stop("Not a graph object")
  }
  cs <- graph.strength(graph,...)
  hi <- hist(cs,-1:max(cs),plot=FALSE)$density
  if (!cumulative) {
    res <- hi
  }
  else {
    res <- rev(cumsum(rev(hi)))
  }
  res
}
graph_strength_distribution(bicimad)
```


```{r}
graph_strength_distribution(bicimad)
degree_distribution(bicimad)
```


```{r}
plot(0:max(strength(bicimad)),graph_strength_distribution(bicimad),
     type="h",col="deepskyblue2",lwd=2,
     main="Weighted degree distribution of karate network",
     xlab="Degree",ylab="Frequency")
points(0:max(strength(bicimad)),graph_strength_distribution(bicimad),pch=20)
```

Analyzing the frequencies plot, we can see that the degrees more repeated in our network are those between 50-100. However, we can also seen that the most repeated one is that with 52 degrees, which is the peak of the curve and it is repeated just once. We can see in the table that it is repeated 8 times, whereas those second most repeated are those with 6 times (76 and 84).

```{r}
which(table(degree(bicimad))==8)
which(table(degree(bicimad))==6)
```


We can also check whether our network is a multigraph or not. Without further knowledge, the network might have loops, as leaving a bike on the same station where it has taken at first seems not only possible but very doable. Indeed we can see that it is a multigraph.

```{r}
is_simple(bicimad)
```



## Is the graph connected? Obtain components, diameter, farther vertices,...

Now, to know if every vertex is reachable from every other i.e. being connected, we can take this function.

```{r}
is_connected(bicimad)
```

As expected, the graph is indeed connected. This is reasonable as there are not constraints about going to one place or another using these type of bike service. You can take a bike from any station and return it whatever different one.

```{r}
components(bicimad)
```

Indeed the components as expected is the whole graph that we have been discussing above.

Now, to know, which is the longest path between vertices, we can obtain its diameter

```{r}
get_diameter(bicimad)
diameter(bicimad)
```

Now considering the weak case, we will see that the diameter is lower than the strong case.

```{r}
get_diameter(bicimad,directed=FALSE)
diameter(bicimad,directed=FALSE)
```


And also the farthest vertice

```{r}
farthest_vertices(bicimad)
```

So, the two stations that are furthest away are "Calle Camino de los Vinateros nÂº 28" and "Avenida de la Complutense". In fact, checking this journey in Google maps, it says that there is a 10km distance between those two and it might take about 40 minutes to get there.








